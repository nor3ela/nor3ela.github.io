"use strict";function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}!function(){function e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function a(e,t,a){return t&&n(e.prototype,t),a&&n(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var o=function(){function e(n){t(this,e),this.hash=Lampa.Utils.hash(n.movie.original_title),this.field="online_selected_voice"}return a(e,[{key:"get",value:function(){return Lampa.Storage.get(this.field,"{}")[this.hash]||""}},{key:"set",value:function(e){var t=Lampa.Storage.get(this.field,"{}");t[this.hash]=e,Lampa.Storage.set(this.field,t)}}]),e}();function r(e){this.data={},this.work=0,this.need=e,this.complited=!1,this.check=function(){this.stopped||this.work>=this.need&&!this.complited&&(this.complited=!0,this.onComplite(this.data))},this.next=function(){this.work++,this.check()},this.append=function(e,t){this.work++,this.data[e]=t,this.check()},this.error=function(){this.work++,this.check()},this.stop=function(){this.stopped=!0}}var s={cache:{},pending:{},getCache:function(){return window.SEASON_FIX&&window.SEASON_FIX.tvmaze_cache?window.SEASON_FIX.tvmaze_cache:this.cache},getSeasonsCount:function(e){var t=this.getCache()[e];return t&&"object"===_typeof(t)&&Object.keys(t).length>0?Object.keys(t).length:null},fetch:function(e,t,n,a){var i=this,o=this.getCache();if(o[e]&&"object"===_typeof(o[e]))a&&a(Object.keys(o[e]).length);else if("loading"===o[e]||this.pending[e])a&&(this.pending[e]||(this.pending[e]=[]),this.pending[e].push(a));else{o[e]="loading",a&&(this.pending[e]=[a]);t||n?this.fetchFromTvmaze(e,t,n):this.fetchExternalIds(e,(function(t){t&&(t.imdb_id||t.tvdb_id)?i.fetchFromTvmaze(e,t.imdb_id,t.tvdb_id):i.finishPending(e,null)}))}},fetchExternalIds:function(e,t){var n=Lampa.TMDB&&Lampa.TMDB.key?Lampa.TMDB.key():null;if(n){var a=Lampa.TMDB&&Lampa.TMDB.api?Lampa.TMDB.api("tv/"+e+"/external_ids?api_key="+n):"https://api.themoviedb.org/3/tv/"+e+"/external_ids?api_key="+n;this.request(a,t)}else t(null)},fetchFromTvmaze:function(e,t,n){var a=this,i=t||n;if(i){var o="https://api.tvmaze.com/lookup/shows?"+(t?"imdb":"thetvdb")+"="+i;this.request(o,(function(t){if(t&&t.id){var n="https://api.tvmaze.com/shows/"+t.id+"/episodes";a.request(n,(function(t){if(t&&t.length){for(var n={},i=0;i<t.length;i++){var o=t[i].season;n[o]||(n[o]=0),n[o]++}var r=a.getCache();Object.keys(n).length>0?(r[e]=n,a.finishPending(e,Object.keys(n).length)):(delete r[e],a.finishPending(e,null))}else a.finishPending(e,null)}))}else a.finishPending(e,null)}))}else this.finishPending(e,null)},finishPending:function(e,t){var n=this.getCache();"loading"===n[e]&&delete n[e];var a=this.pending[e];delete this.pending[e],a&&a.length&&a.forEach((function(e){e(t)}))},request:function(e,t){var n=new Lampa.Reguest;n.timeout(1e4);var a=function(e){t(e)},i=function(){t(null)};-1!==e.indexOf("themoviedb.org")||-1!==e.indexOf("apitmdb.")?n.silent(e,a,i):n.native(e,a,i)}},l=["Анастасия Гайдаржи + Андрей Юрченко","Студии Суверенного Лепрозория","IgVin &amp; Solncekleshka","Студия Пиратского Дубляжа","Gremlin Creative Studio","Alternative Production","Bubble Dubbing Company","HelloMickey Production","Н.Севастьянов seva1988","XDUB Dorama + Колобок","Мобильное телевидение","СПД - Сладкая парочка","BBC Saint-Petersburg","Black Street Records","Intra Communications","Melodic Voice Studio","Selena International","Voice Project Studio","Несмертельное оружие","Петербургский дубляж","Asian Miracle Group","Lizard Cinema Trade","National Geographic","Studio Victory Аsia","True Dubbing Studio","Позитив-Мультимедиа","Премьер Мультимедиа","Уолт Дисней Компани","Family Fan Edition","Paramount Pictures","Parovoz Production","Shadow Dub Project","The Kitchen Russia","Zone Vision Studio","Анастасия Гайдаржи","Иванова и П. Пашут","Малиновский Сергей","Так Треба Продакшн","Back Board Cinema","Paramount Channel","Project Web Mania","RedDiamond Studio","Universal Channel","Zoomvision Studio","НеЗупиняйПродакшн","Селена Интернешнл","Студия «Стартрек»","Хихикающий доктор","Четыре в квадрате","Brain Production","Cowabunga Studio","Lucky Production","MC Entertainment","Paramount Comedy","Universal Russia","Анатолий Ашмарин","Андрей Питерский","Васька Куролесов","Екатеринбург Арт","Квадрат Малевича","Первый канал ОРТ","Реальный перевод","Русский Репортаж","Сolumbia Service","Amazing Dubbing","AnimeSpace Team","Cartoon Network","Cinema Prestige","CinemaSET GROUP","DeadLine Studio","DeeAFilm Studio","GreenРай Studio","New Dream Media","Sunshine Studio","Volume-6 Studio","XvidClub Studio","Антонов Николай","Воробьев Сергей","Денис Шадинский","З Ранку До Ночі","Максим Логинофф","Николай Дроздов","Студия Горького","Студийная банда","Ульпаней Эльром","Agatha Studdio","Anything-group","CrazyCatStudio","Creative Sound","DIVA Universal","Garsu Pasaulis","GoodTime Media","Goodtime Media","Hamster Studio","Horizon Studio","Jakob Bellmann","Julia Prosenuk","KosharaSerials","Kulzvuk Studio","Mallorn Studio","Red Head Sound","RedRussian1337","SovetRomantica","SunshineStudio","Syfy Universal","TUMBLER Studio","Viasat History","visanti-vasaer","Анатолий Гусев","Вартан Дохалов","Витя «говорун»","Кирдин | Stalk","Л. Володарский","Леша Прапорщик","Максим Жолобов","Медиа-Комплекс","Прайд Продакшн","Русский дубляж","Союзмультфильм","Студия Колобок","5-й канал СПб","ARRU Workshop","Arasi project","Banyan Studio","Bars MacAdams","Bonsai Studio","Byako Records","Dream Records","FiliZa Studio","Filiza Studio","Film Prestige","Flarrow Films","Gezell Studio","Greb&Creative","HamsterStudio","Jetvis Studio","LE-Production","Lizard Cinema","Nazel & Freya","PCB Translate","Rainbow World","Renegade Team","SHIZA Project","Sci-Fi Russia","Amanogawa","The Mike Rec.","VIP Serial HD","VO-Production","VO-production","Victory-Films","ViruseProject","Voice Project","Vulpes Vulpes","АРК-ТВ Studio","Видеопродакшн","Мадлен Дюваль","Мика Бондарик","Наталья Гурзо","Премьер Видео","Семыкина Юлия","Старый Бильбо","Трамвай-фильм","Фортуна-Фильм","Хоррор Мэйкер","Храм Дорам ТВ","Штамп Дмитрий","A. Lazarchuk","AlphaProject","AniLibria.TV","AnimeReactor","Animereactor","BadCatStudio","DreamRecords","General Film","HaseRiLLoPaW","Horror Maker","Ivnet Cinema","Korean Craze","Light Breeze","Mystery Film","Oneinchnales","Profix Media","Psychotronic","RG Paravozik","RG.Paravozik","RussianGuy27","Sony Channel","Train Studio","Trdlo.studio","ViP Premiere","VictoryFilms","VulpesVulpes","Wayland team","sweet couple","Альтера Парс","Видеоимпульс","Гей Кино Гид","Говинда Рага","Деваль Видео","Е. Хрусталёв","К. Поздняков","Кармен Видео","Кинопремьера","Кирилл Сагач","КонтентикOFF","Кубик в Кубе","Кураж-Бамбей","Мьюзик-трейд","Н. Золотухин","Не требуется","Новый Дубляж","Нурмухаметов","Оригинальный","Первый канал","Р. Янкелевич","С. Кузьмичёв","С. Щегольков","Сергей Дидок","Синема Трейд","Синта Рурони","Студия Райдо","Тоникс Медиа","Точка Zрения","Фильмэкспорт","Элегия фильм","1001 cinema","BTI Studios","Cactus Team","CrezaStudio","Crunchyroll","DVD Classic","Description","Eurochannel","FocusStudio","Franek Monk","Gala Voices","Gears Media","GladiolusTV","Gold Cinema","Good People","HiWay Grope","Inter Video","JWA Project","Lazer Video","Max Nabokov","NEON Studio","Neoclassica","New Records","Nickelodeon","Nika Lenina","Oghra-Brown","Paul Bunyan","Rebel Voice","RecentFilms","RiZZ_fisher","Saint Sound","SakuraNight","SnowRecords","Sony Sci-Fi","Sound-Group","StudioFilms","TF-AniGroup","TrainStudio","XDUB Dorama","Zone Studio","Zone Vision","hungry_inri","Варус Видео","Варус-Видео","Видеосервис","Володарский","Г. Либергал","Г. Румянцев","Другое кино","Е. Гаевский","Завгородний","И. Сафронов","И. Степанов","Кенс Матвей","КураСгречей","Лазер Видео","Малиновский","Мастер Тэйп","Неоклассика","Новый Канал","Огородников","Петербуржец","Прямостанов","С. Визгунов","С. Кузнецов","Севастьянов","Студия Трёх","Цікава Ідея","Эй Би Видео","Я. Беллманн","1001cinema","1WinStudio","AXN Sci-Fi","AimaksaLTV","Animegroup","ApofysTeam","AvePremier","BraveSound","CP Digital","CactusTeam","CinemaTone","Contentica","CoralMedia","DniproFilm","ELEKTRI4KA","East Dream","Fox Russia","HiWayGrope","LevshaFilm","MaxMeister","Mega-Anime","MifSnaiper","NewStation","Nice-Media","Pazl Voice","PiratVoice","Postmodern","Rain Death","Reanimedia","Shachiburi","SilverSnow","Sky Voices","SkyeFilmTV","Sony Turbo","Sound Film","StudioBand","TatamiFilm","VGM Studio","VSI Moscow","VoicePower","West Video","W³: voices","eraserhead","Б. Федоров","Бусов Глеб","Ващенко С.","Глуховский","Держиморда","Е. Гранкин","И. Еремеев","Интерфильм","Инфо-фильм","К. Филонов","Карповский","Комедия ТВ","Костюкевич","Мост Видео","Мост-Видео","Н. Антонов","Н. Дроздов","Новый диск","Ох! Студия","Первый ТВЧ","Переводман","С. Казаков","С. Лебедев","С. Макашов","Саня Белый","Союз Видео","Студия NLS","Т.О Друзей","ТВ XXI век","Толстобров","Хуан Рохас","Электричка","Ю. Немахов","диктор CDV","3df voice","AAA-Sound","Andre1288","AniLibria","AniPLague","Astana TV","AveBrasil","AveDorama","BeniAffet","CBS Drama","CLS Media","CasStudio","Discovery","DoubleRec","Epic Team","FanStudio","FilmsClub","Flux-Team","Fox Crime","GREEN TEA","Ghostface","GoodVideo","Gramalant","HighHopes","INTERFILM","JoyStudio","KinoGolos","Kinomania","Kobayashi","LakeFilms","Neo-Sound","NewComers","NewStudio","No-Future","Novamedia","OnisFilms","Persona99","RATTLEBOX","RainDeath","Red Media","SDI Media","SOLDLUCK2","Sawyer888","Sedorelli","Seoul Bay","Sephiroth","ShinkaDan","SmallFilm","SpaceDust","Timecraft","Total DVD","VIZ Media","Video-BIZ","Videogram","fiendover","turok1990","ААА-sound","Амальгама","АрхиТеатр","Васильцев","Весельчак","Видеобаза","Воротилин","Григорьев","Деньщиков","ЕА Синема","Зереницын","Золотухин","И. Клушин","Имидж-Арт","Карапетян","Киномания","Кириллица","Машинский","Мительман","Муравский","Невафильм","Останкино","Причудики","Рыжий пес","С. Дьяков","СВ Студия","СВ-Студия","Самарский","Синема УС","Советский","Солодухин","ТО Друзей","Формат AB","Хрусталев","Шадинский","Ю. Сербин","Ю. Товбин","Янкелевич","AB-Video","ALEKS KV","ANIvoice","AdiSound","AlexFilm","Amalgama","AniMaunt","AniMedia","Animedub","AuraFilm","AzOnFilm","Barin101","ClubFATE","ColdFilm","DeadLine","DexterTV","Extrabit","FilmGate","Fox Life","Foxlight","GetSmart","GoldTeam","GostFilm","Gravi-TV","Hallmark","IdeaFilm","ImageArt","JeFerSon","Jimmy J.","Kerems13","KinoView","Loginoff","LostFilm","MOYGOLOS","Marclail","Milirina","MiraiDub","Murzilka","NovaFilm","OMSKBIRD","Omskbird","Radamant","RealFake","RoxMarty","STEPonee","SorzTeam","Superbit","TurkStar","Ultradox","VashMax2","VendettA","VideoBIZ","WestFilm","XL Media","kubik&ko","metalrus","st.Elrom","Алексеев","Артемьев","АрхиАзия","Бахурани","Бессонов","Васильев","Визгунов","Войсовер","Воронцов","Гаврилов","Гаевский","Горчаков","Дольский","Домашний","Дубровин","Дьяконов","Е. Лурье","Е. Рудой","Журавлев","Заугаров","Индия ТВ","Ист-Вест","Карусель","Кинолюкс","Кузнецов","ЛанселаП","Лексикон","Ленфильм","Либергал","Логинофф","Марченко","Махонько","Медведев","Мельница","Мосфильм","Нарышкин","Оверлорд","Оригинал","Пирамида","С. Рябов","СВ-Дубль","Савченко","Субтитры","Супербит","Тимофеев","Толмачев","Хлопушка","Ю. Живов","5 канал","Amalgam","AniFilm","AniStar","AniWayt","Anifilm","Anistar","AnyFilm","AveTurk","BadBajo","BaibaKo","BukeDub","DeadSno","ELYSIUM","Eladiel","Elysium","F-TRAIN","FireDub","FoxLife","HDrezka","Hamster","Janetta","Jaskier","Kолобок","LeDoyen","Levelin","Liga HQ","Lord32x","MUZOBOZ","Macross","McElroy","MixFilm","NemFilm","Netflix","Octopus","Onibaku","OpenDub","Paradox","PashaUp","RUSCICO","RusFilm","SOFTBOX","Sam2007","SesDizi","ShowJet","SoftBox","SomeWax","TV 1000","TVShows","To4kaTV","Trina_D","Twister","Urasiko","VicTeam","Wakanim","ZM-SHOW","ZM-Show","datynet","lord666","sf@irat","Абдулов","Багичев","Бибиков","Ващенко","Герусов","Данилов","Дасевич","Дохалов","Кипарис","Клюквин","Колобок","Королев","Королёв","Латышев","Люсьена","Матвеев","Михалев","Морозов","Назаров","Немахов","Никитин","Омикрон","Ошурков","Парадиз","Пепелац","Пифагор","Позитив","Пятница","РуФилмс","Рутилов","СВ-Кадр","Синхрон","Смирнов","Сокуров","Сонотек","Сонькин","Сыендук","Филонов","Хихидок","Яковлев","Яроцкий","заКАДРЫ","100 ТВ","4u2ges","Alezan","Amedia","Ancord","AniDUB","Anubis","Azazel","BD CEE","Berial","Boльгa","Cuba77","D.I.M.","DubLik","Dubляж","Elegia","Emslie","FocusX","GalVid","Gemini","Jetvis","JimmyJ","KANSAI","KOleso","Kansai","Kiitos","L0cDoG","LeXiKC","Lisitz","Mikail","Milvus","MrRose","Nastia","NewDub","OSLIKt","Ozz TV","Ozz.tv","Prolix","RedDog","Rumble","SNK-TV","Satkur","Selena","Shaman","Stevie","Suzaku","TV1000","Tycoon","UAFlix","WVoice","WiaDUB","ZEE TV","Zendos","Zerzia","binjak","den904","kiitos","madrid","neko64","АБыГДе","Агапов","Акалит","Акопян","Акцент","Альянс","Анубис","Арк-ТВ","Бойков","Векшин","Вихров","Вольга","Гоблин","Готлиб","Гризли","Гундос","Гуртом","ДиоНиК","Дьяков","Есарев","Живаго","Жучков","Зебуро","Иванов","Карцев","Кашкин","Килька","Киреев","Козлов","Кондор","Котова","Кошкин","Кравец","Курдов","Лагута","Лапшин","Лизард","Миняев","Мудров","Н-Кино","НЕВА 1","НЛО-TV","Набиев","Нева-1","Пронин","Пучков","Ракурс","Россия","С.Р.И.","Санаев","Светла","Сербин","Стасюк","Строев","ТВ СПб","Товбин","Шварко","Швецов","Шуваев","Amber","AniUA","Anika","Arisu","Cmert","D2Lab","D2lab","DeMon","Elrom","IНТЕР","JetiX","Jetix","Kerob","Lupin","Ozeon","PaDet","RinGo","Ryc99","SHIZA","Solod","To4ka","erogg","ko136","seqw0","ssvss","zamez","Акира","АнВад","Белов","Бигыч","ВГТРК","Велес","Ворон","Гланц","Живов","Игмар","Интер","Котов","Лайко","Мишин","Новий","Перец","Попов","Райдо","РенТВ","Рудой","Рукин","Рыбин","Рябов","С.Р.И","ТВЧ 1","Хабар","Чадов","Штамп","Штейн","Andy","CPIG","Dice","ETV+","Gits","ICTV","Jade","KIHO","Laci","RAIM","SGEV","Tori","Troy","Twix","Vano","Voiz","jept","ИДДК","Инис","Ирэн","Нота","ТВ-3","ТВИН","Твин","Чуев","1+1","2+2","2x2","2х2","AMC","AMS","AOS","CDV","DDV","FDV","FOX","ICG","IVI","JAM","LDV","MCA","MGM","MTV","Oni","QTV","TB5","V1R","VHS","АМС","ГКГ","ДТВ","ИГМ","КТК","МИР","НСТ","НТВ","НТН","РТР","СТС","ТВ3","ТВ6","ТВЦ","ТНТ","ТРК","Че!","D1","R5","К9","Закадровый","Многоголосый"];l.sort((function(e,t){return t.length-e.length})),Lampa.Lang.add({huyfix_wait:{ru:"Секундочку...",en:"Wait a moment...",uk:"Секундочку...",zh:"稍等..."},huyfix_error_title:{ru:"Вот досада...",en:"What a pity...",uk:"От прикрість...",zh:"真遗憾..."},huyfix_no_files:{ru:"Нет доступных файлов для воспроизведения с выбранным переводом",en:"No files available for playback with selected translation",uk:"Немає доступних файлів для відтворення з обраним перекладом",zh:"所选翻译没有可播放的文件"},huyfix_want_other:{ru:"Хотите выбрать другой?",en:"Do you want to choose another?",uk:"Хочете обрати інший?",zh:"您想选择另一个吗？"},huyfix_choose_other:{ru:"Выбрать другой",en:"Choose another",uk:"Обрати інший",zh:"选择另一个"},huyfix_choose_translation:{ru:"Выберите перевод",en:"Choose translation",uk:"Оберіть переклад",zh:"选择翻译"},huyfix_choose_stream:{ru:"Выберите поток",en:"Choose stream",uk:"Оберіть потік",zh:"选择流"},huyfix_stream:{ru:"Поток",en:"Stream",uk:"Потік",zh:"流"},huyfix_default:{ru:"Неизвестный перевод",en:"Unknown translation",uk:"Невідомий переклад",zh:"未知翻译"},huyfix_no_content:{ru:"К сожалению, не удалось найти видеоконтент для этого фильма. Попробуйте выбрать другой фильм или повторите попытку позже.",en:"Unfortunately, we couldn't find video content for this movie. Try selecting another movie or try again later.",uk:"На жаль, не вдалося знайти відеоконтент для цього фільму. Спробуйте обрати інший фільм або повторіть спробу пізніше.",zh:"很抱歉，我们找不到这部电影的视频内容。请尝试选择其他电影或稍后再试。"},huyfix_no_links:{ru:"Не удалось найти ссылок, выберите другой перевод",en:"Could not find links, choose another translation",uk:"Не вдалося знайти посилань, оберіть інший переклад",zh:"找不到链接，请选择其他翻译"},huyfix_server_address:{ru:"Адрес сервера",en:"Server address",uk:"Адреса сервера",zh:"服务器地址"},huyfix_add_server:{ru:"Добавить сервер",en:"Add server",uk:"Додати сервер",zh:"添加服务器"},huyfix_choose_server:{ru:"Выбор сервера",en:"Choose server",uk:"Вибір сервера",zh:"选择服务器"},huyfix_edit:{ru:"Редактировать",en:"Edit",uk:"Редагувати",zh:"编辑"},huyfix_delete:{ru:"Удалить",en:"Delete",uk:"Видалити",zh:"删除"},huyfix_server_not_specified:{ru:"Сервер не указан",en:"Server not specified",uk:"Сервер не вказано",zh:"未指定服务器"},huyfix_search_sources:{ru:"Поиск источников...",en:"Searching sources...",uk:"Пошук джерел...",zh:"搜索源..."},huyfix_access_denied:{ru:"Доступ запрещён",en:"Access denied",uk:"Доступ заборонено",zh:"访问被拒绝"},huyfix_sources_not_found:{ru:"Источники не найдены",en:"Sources not found",uk:"Джерела не знайдено",zh:"未找到源"},huyfix_connection_error:{ru:"Ошибка соединения",en:"Connection error",uk:"Помилка з'єднання",zh:"连接错误"},huyfix_auto_detect:{ru:"Подобрать автоматически",en:"Auto detect",uk:"Підібрати автоматично",zh:"自动检测"},huyfix_select_all_sources:{ru:"Выбрать все источники",en:"Select all sources",uk:"Обрати всі джерела",zh:"选择所有源"},huyfix_may_cause_bugs:{ru:"Может вызвать баги и увеличит задержку при открытии плеера",en:"May cause bugs and increase delay when opening player",uk:"Може викликати баги та збільшить затримку при відкритті плеєра",zh:"可能导致错误并增加播放器打开延迟"},huyfix_reset_default:{ru:"Сбросить по умолчанию",en:"Reset to default",uk:"Скинути за замовчуванням",zh:"重置为默认"},huyfix_choose_sources:{ru:"Выбор источников",en:"Choose sources",uk:"Вибір джерел",zh:"选择源"},huyfix_found_sources:{ru:"Найдено источников",en:"Found sources",uk:"Знайдено джерел",zh:"找到源"},huyfix_all_selected:{ru:"Выбраны все источники",en:"All sources selected",uk:"Обрано всі джерела",zh:"已选择所有源"},huyfix_sources_reset:{ru:"Источники сброшены",en:"Sources reset",uk:"Джерела скинуто",zh:"源已重置"},huyfix_refresh_list:{ru:"Обновить список",en:"Refresh list",uk:"Оновити список",zh:"刷新列表"},huyfix_public_servers:{ru:"Публичные серверы",en:"Public servers",uk:"Публічні сервери",zh:"公共服务器"},huyfix_already_added:{ru:"Уже добавлен",en:"Already added",uk:"Вже додано",zh:"已添加"},huyfix_loading:{ru:"Загрузка...",en:"Loading...",uk:"Завантаження...",zh:"加载中..."},huyfix_servers_not_found:{ru:"Серверы не найдены",en:"Servers not found",uk:"Сервери не знайдено",zh:"未找到服务器"},huyfix_checking_servers:{ru:"Проверка серверов",en:"Checking servers",uk:"Перевірка серверів",zh:"检查服务器"},huyfix_no_working_servers:{ru:"Рабочие серверы не найдены",en:"No working servers found",uk:"Робочі сервери не знайдено",zh:"未找到可用服务器"},huyfix_load_error:{ru:"Ошибка загрузки",en:"Loading error",uk:"Помилка завантаження",zh:"加载错误"},huyfix_online_title:{ru:"Онлайн HFix",en:"Online HFix",uk:"Онлайн HFix",zh:"在线 HFix"},huyfix_always_show_choices:{ru:"Всегда выбирать озвучку и качество",en:"Always select voice and quality",uk:"Завжди вибирати озвучення і якість",zh:"总是选择配音和质量"},huyfix_always_show_choices_desc:{ru:"Всегда показывать выбор озвучки и потока",en:"Always show voice and stream selection",uk:"Завжди показувати вибір озвучення та потоку",zh:"始终显示配音和流选择"},huyfix_work_mode:{ru:"Режим работы",en:"Work mode",uk:"Режим роботи",zh:"工作模式"},huyfix_use_bwa:{ru:"Использовать BWA",en:"Use BWA",uk:"Використовувати BWA",zh:"使用 BWA"},huyfix_switch_server_bwa:{ru:"Переключить между сервером и BWA",en:"Switch between server and BWA",uk:"Перемкнути між сервером та BWA",zh:"在服务器和 BWA 之间切换"},huyfix_yes:{ru:"Да",en:"Yes",uk:"Так",zh:"是"},huyfix_no:{ru:"Нет",en:"No",uk:"Ні",zh:"否"},huyfix_bwa_code:{ru:"BWA код",en:"BWA code",uk:"BWA код",zh:"BWA 代码"},huyfix_enter_bwa_code:{ru:"Введите код от bwa.to (например: abc1xyz)",en:"Enter code from bwa.to (example: abc1xyz)",uk:"Введіть код від bwa.to (наприклад: abc1xyz)",zh:"输入来自 bwa.to 的代码（例如：abc1xyz）"},huyfix_not_specified:{ru:"Не указан",en:"Not specified",uk:"Не вказано",zh:"未指定"},huyfix_own_server:{ru:"Свой сервер",en:"Own server",uk:"Власний сервер",zh:"自己的服务器"},huyfix_server_example:{ru:"Например: 192.168.1.1:9118",en:"Example: 192.168.1.1:9118",uk:"Наприклад: 192.168.1.1:9118",zh:"例如：192.168.1.1:9118"},huyfix_sources_title:{ru:"Источники",en:"Sources",uk:"Джерела",zh:"源"},huyfix_choose_balancers:{ru:"Выбрать балансеры для поиска",en:"Choose balancers for search",uk:"Обрати балансери для пошуку",zh:"选择搜索平衡器"},huyfix_servers_list:{ru:"Список серверов",en:"Servers list",uk:"Список серверів",zh:"服务器列表"},huyfix_bwa_saved:{ru:"BWA код сохранён",en:"BWA code saved",uk:"BWA код збережено",zh:"BWA 代码已保存"},huyfix_current_server:{ru:"Текущий сервер",en:"Current server",uk:"Поточний сервер",zh:"当前服务器"},huyfix_token_set:{ru:"Токен установлен",en:"Token set",uk:"Токен встановлено",zh:"令牌已设置"},huyfix_select:{ru:"Выбрать",en:"Select",uk:"Обрати",zh:"选择"},huyfix_change_token:{ru:"Изменить токен",en:"Change token",uk:"Змінити токен",zh:"更改令牌"},huyfix_add_token:{ru:"Добавить токен",en:"Add token",uk:"Додати токен",zh:"添加令牌"},huyfix_delete_token:{ru:"Удалить токен",en:"Delete token",uk:"Видалити токен",zh:"删除令牌"},huyfix_server_token:{ru:"Токен сервера",en:"Server token",uk:"Токен сервера",zh:"服务器令牌"},huyfix_token_saved:{ru:"Токен сохранён",en:"Token saved",uk:"Токен збережено",zh:"令牌已保存"},huyfix_token_deleted:{ru:"Токен удалён",en:"Token deleted",uk:"Токен видалено",zh:"令牌已删除"},huyfix_online:{ru:"Онлайн",en:"Online",uk:"Онлайн",zh:"在线"},huyfix_server:{ru:"Сервер",en:"Server",uk:"Сервер",zh:"服务器"},huyfix_close:{ru:"Закрыть",en:"Close",uk:"Закрити",zh:"关闭"}});var u="online_servers",c="online_active_server",d="online_sources",f="online_bwa_code",m="online_use_bwa",h="online_server_tokens",p="online_always_show_choices",v="rc.bwa.to",y='<svg viewBox="3 6 42 36" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="5" y="8" width="38" height="32" rx="2" stroke="currentColor" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/><path d="M13 8v32M5 16h8m-8 8h8m-8 8h8" stroke="currentColor" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/><circle cx="28" cy="24" r="9" stroke="currentColor" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/><circle cx="28" cy="24" r="3" fill="currentColor"/></svg>',_=[{id:"rezka",name:"rezka",enabled:!0},{id:"rc/rhs",name:"rc/rhs",enabled:!1},{id:"rhsprem",name:"rhsprem",enabled:!0},{id:"kinopub",name:"kinopub",enabled:!0},{id:"vokino",name:"vokino",enabled:!0},{id:"mirage",name:"mirage",enabled:!1},{id:"alloha",name:"alloha",enabled:!0},{id:"rc/filmix",name:"rc/filmix",enabled:!1},{id:"rc/fxapi",name:"rc/fxapi",enabled:!1},{id:"fxapi",name:"fxapi",enabled:!1},{id:"filmix",name:"filmix",enabled:!1},{id:"filmixtv",name:"filmixtv",enabled:!1},{id:["videocdn","lumex"],name:"lumex",enabled:!0},{id:"kinogo",name:"kinogo",enabled:!0},{id:"vkmovie",name:"VK",enabled:!1},{id:"rutubemovie",name:"rutube",enabled:!1},{id:"videodb",name:"videodb",enabled:!1},{id:"collaps",name:"collaps",enabled:!1},{id:"collaps-dash",name:"collaps-dash",enabled:!1},{id:"hdvb",name:"hdvb",enabled:!0},{id:"zetflix",name:"zetflix",enabled:!1},{id:"veoveo",name:"veoveo",enabled:!1},{id:"kodik",name:"kodik",enabled:!0},{id:"ashdi",name:"ashdi",enabled:!1},{id:"kinoukr",name:"kinoukr",enabled:!1},{id:"kinotochka",name:"kinotochka",enabled:!1},{id:"remux",name:"remux",enabled:!1},{id:"iframevideo",name:"iframevideo",enabled:!1},{id:"cdnmovies",name:"cdnmovies",enabled:!1},{id:"anilibria",name:"anilibria",enabled:!1},{id:"animedia",name:"animedia",enabled:!1},{id:"animego",name:"animego",enabled:!1},{id:"animevost",name:"animevost",enabled:!1},{id:"animebesst",name:"animebesst",enabled:!1},{id:"redheadsound",name:"redheadsound",enabled:!1},{id:"animelib",name:"animelib",enabled:!1},{id:"moonanime",name:"moonanime",enabled:!1},{id:"vibix",name:"vibix",enabled:!1},{id:"vdbmovies",name:"vdbmovies",enabled:!1},{id:"fancdn",name:"fancdn",enabled:!1},{id:"cdnvideohub",name:"cdnvideohub",enabled:!1},{id:"vcdn",name:"vcdn",enabled:!1},{id:"hydraflix",name:"hydraflix",enabled:!1},{id:"videasy",name:"videasy",enabled:!1},{id:"vidsrc",name:"vidsrc",enabled:!1},{id:"movpi",name:"movpi",enabled:!1},{id:"vidlink",name:"vidlink",enabled:!1},{id:"twoembed",name:"twoembed",enabled:!1},{id:"autoembed",name:"autoembed",enabled:!1},{id:"smashystream",name:"smashystream",enabled:!1},{id:"rgshows",name:"rgshows",enabled:!1},{id:"pidtor",name:"pidtor",enabled:!1},{id:"videoseed",name:"videoseed",enabled:!1},{id:"iptvonline",name:"iptvonline",enabled:!1},{id:"eneyida",name:"eneyida",enabled:!1},{id:"kinobase",name:"kinobase",enabled:!1}];function g(){return _.filter((function(e){return e.enabled})).map((function(e){return Lampa.Arrays.isArray(e.id)?e.id[0]:e.id}))}function L(){var e=Lampa.Storage.get(u,[]);if("string"==typeof e)try{e=JSON.parse(e)}catch(t){e=[]}return Lampa.Arrays.isArray(e)||(e=[]),e}function b(){var e=L(),t=parseInt(Lampa.Storage.get(c,0))||0;return t>=e.length&&(t=0),t}function k(e){Lampa.Storage.set(c,e)}function w(e){if(!e)return!1;var t=L();return-1===t.indexOf(e)&&(t.push(e),Lampa.Storage.set(u,t),!0)}function x(e){var t=L();return e>=0&&e<t.length&&(t.splice(e,1),Lampa.Storage.set(u,t),b()>=t.length&&k(Math.max(0,t.length-1)),!0)}function S(){var e=L();if(0===e.length)return"";var t=e[b()]||"";return t&&0!==(t=t.replace(/\/+$/,"")).indexOf("http://")&&0!==t.indexOf("https://")&&(t="http://"+t),t}function C(e){return e.replace(/^https?:\/\//,"")}function A(){var e=Lampa.Storage.get(d,[]);if("string"==typeof e)try{e=JSON.parse(e)}catch(t){e=[]}return Lampa.Arrays.isArray(e)&&0!==e.length||(e=g()),e.map((function(e){return Lampa.Arrays.isArray(e)?e[0]:e}))}function T(e){Lampa.Storage.set(d,e)}function O(){return Lampa.Storage.get(f,"")}function P(){return Lampa.Storage.get(m,!1)}function z(e){Lampa.Storage.set(m,e)}function F(){return Lampa.Storage.get(p,!1)}function E(e){Lampa.Storage.set(p,e)}function R(){var e=Lampa.Storage.get(h,"{}");if("string"==typeof e)try{e=JSON.parse(e)}catch(t){e={}}return e||{}}function D(e){return R()[e]||""}function j(e,t){var n=R();t?n[e]=t:delete n[e],Lampa.Storage.set(h,n)}var B={lampa:"Lampa.",get stream(){if(P())return v;var e=S();return e?e.replace(/^https?:\/\//,""):""},get sources(){return A()},nolite:[],filter_ts:["ts","тс","tс","тc","чистый звук"],filter_hr:["HDR10","HEVC"],filter_db:["Дубляж","Дублированный","Red Head Sound","Мосфильм","Dubляж"],filter_tv:[],filter_uk:["uk","ukr","укр"],filter_du:["Дубляж","Дублированный","Полное дублирование"],rename_translate:{HDRezka:["HDrezka Studio","RezkaStudio","Rezka Studio","Rezka"],StudioBand:["Студийная Банда","StudioBand","Studio Band"],"Дубляж":["Дубляж","Дублированный","Полное дублирование"],"Оригинал":["Не требуется","Оригинальный"],"Закадровый":["Многоголосый","Закадровый"]},filter_translate:l};function q(e,t){var n=e.toLowerCase().replace(/ /g,"").split(/\.|\[/)[0],a=t.toLowerCase().replace(/ /g,"").split(/\.|\[/)[0];return!(!n||!a)&&(n.indexOf(a)>-1||a.indexOf(n)>-1)}function V(){var e=Lampa.Storage.get("region","{}");return e.code?e.code:"ru"}function I(e){return e.translate||e.name||e.details||e.title||""}function M(e){return e.forEach((function(e){["translate","title","details","name"].forEach((function(t){if(e[t]){if(0===e[t].indexOf(Lampa.Lang.translate("huyfix_default")))return;if(/^\d{3,4}p$/i.test(e[t]))return void(e[t]=Lampa.Lang.translate("huyfix_default"));if(e[t]=(o=/\(([^()]+)\)$/,r=1,s=e[t],(l=s.match(o))&&l[r]?l[r]:s),/^\d{3,4}p$/i.test(e[t]))return void(e[t]=Lampa.Lang.translate("huyfix_default"));var n=!1;B.filter_translate.forEach((function(a){e[t].toLowerCase().indexOf(a.toLowerCase())>=0&&(e[t]=a,n=!0)}));var a=function(a){B.rename_translate[a].forEach((function(i){e[t].toLowerCase()==i.toLowerCase()&&(e[t]=a,n=!0)}))};for(var i in B.rename_translate)a(i);B.filter_du.forEach((function(a){e[t].toLowerCase().indexOf(a.toLowerCase())>=0&&(e[t]=a,n=!0)})),n||(e[t]=Lampa.Lang.translate("huyfix_default"))}var o,r,s,l}))})),e}var N={compareVoice:q,region:V,voice:I,player:function(){return Lampa.Platform.is("tizen")||Lampa.Platform.is("webos")?"inner":Lampa.Storage.field("player")},filterTranslate:function(e){if(!e||!Lampa.Arrays.isArray(e)||0===e.length)return[];var t=e.filter((function(e){return 0==B.filter_hr.filter((function(t){return I(e).toLowerCase().indexOf(t.toLowerCase())>=0})).length}));return t=t.filter((function(e){return 0==B.filter_ts.filter((function(t){return I(e).toLowerCase().indexOf(" "+t.toLowerCase())>=0})).length})),"ru"==V()&&(t=t.filter((function(e){return 0==B.filter_uk.filter((function(t){return I(e).toLowerCase().indexOf(t.toLowerCase())>=0})).length}))),M(t),t},renameTranslate:M,sortDUBTranstale:function(e){e.sort((function(e,t){var n=B.filter_db.filter((function(t){return I(e).toLowerCase().indexOf(t.toLowerCase())>=0})).length,a=B.filter_db.filter((function(e){return I(t).toLowerCase().indexOf(e.toLowerCase())>=0})).length;return n&&!a?-1:!n&&a?1:0}))},modalChoiceTranstale:function(e,t){var n=Lampa.Controller.enabled().name,a=$('<div class="connect-broken">\n\t\t\t\t\t\t<div class="connect-broken__icon icon--nofound"></div>\n\t\t\t\t\t\t<div class="connect-broken__title">'.concat(Lampa.Lang.translate("huyfix_error_title"),'</div>\n\t\t\t\t\t\t<div class="connect-broken__text">').concat(Lampa.Lang.translate("huyfix_no_files")," (<b>").concat(e.from,"</b>). ").concat(Lampa.Lang.translate("huyfix_want_other"),'</div>\n\t\t\t\t\t\t<div class="connect-broken__footer">\n\t\t\t\t\t\t\t<div class="selector simple-button next">').concat(Lampa.Lang.translate("huyfix_choose_other"),"</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>"));a.find(".selector").on("hover:enter",(function(){Lampa.Modal.close(),Lampa.Controller.toggle(n)})),a.find(".next").on("hover:enter",(function(){Lampa.Select.show({title:Lampa.Lang.translate("huyfix_choose_translation"),items:e.voicelist,onBack:function(){Lampa.Controller.toggle(n),t&&t()}})})),Lampa.Modal.open({title:"",html:a,onBack:function(){Lampa.Modal.close(),Lampa.Controller.toggle(n),t&&t()}})},unicleTranslations:function(e){var t=[];return e.forEach((function(e){t.find((function(t){return q(I(t),I(e))}))||t.push(e)})),t},selectChoiceTranstale:function(e,t,n){var a={};e.forEach((function(e){var t=I(e);a[t]||(a[t]={items:[],sources:[],maxquality:0}),a[t].items.push(e);var n=e.source_name||"";n&&-1===a[t].sources.indexOf(n)&&a[t].sources.push(n);var i=parseInt(e.maxquality)||0;i>a[t].maxquality&&(a[t].maxquality=i)}));var i=[];for(var o in a){var r=a[o],s=[];r.sources.length>0&&s.push(r.sources.join(", ")),r.maxquality>0&&s.push(r.maxquality+"p"),i.push({title:o,subtitle:s.join(" • "),selected:q(o,t),voiceItems:r.items,onSelect:function(){Lampa.Controller.toggle("content"),n(this.voiceItems[0])}})}Lampa.Select.show({title:Lampa.Lang.translate("huyfix_choose_translation"),items:i,onBack:function(){Lampa.Controller.toggle("content")}})},selectChoiceFlow:function(e,t){Lampa.Select.show({title:Lampa.Lang.translate("huyfix_choose_stream"),items:e.map((function(e){return{title:e.quality+(e.label?"<sub>"+e.label+"</sub>":""),selected:e.selected,subtitle:Lampa.Utils.shortText(e.url,35),onSelect:function(){Lampa.Controller.toggle("content"),t(e)}}})),onBack:function(){Lampa.Controller.toggle("content")}})}};function U(e){if(e+="",-1==(e=Lampa.Utils.addUrlComponent(e,"rjson=true")).indexOf("uid=")){var t=Lampa.Storage.get("lampac_unic_id","")||"guest";e=Lampa.Utils.addUrlComponent(e,"uid="+encodeURIComponent(t))}if(P()){if(-1==e.indexOf("account_email=")){var n=Lampa.Storage.get("account_email","");n&&(e=Lampa.Utils.addUrlComponent(e,"account_email="+encodeURIComponent(n)))}if(-1==e.indexOf("token=")){var a=O();a&&(e=Lampa.Utils.addUrlComponent(e,"token="+encodeURIComponent(a)))}if(-1==e.indexOf("nws_id=")&&window.rch_nws&&window.rch_nws[G]){var i=window.rch_nws[G].connectionId||"";i&&(e=Lampa.Utils.addUrlComponent(e,"nws_id="+encodeURIComponent(i)))}if(-1==e.indexOf("rchtype=")){var o=window.rch_nws&&window.rch_nws[G]&&window.rch_nws[G].type||"web";e=Lampa.Utils.addUrlComponent(e,"rchtype="+o)}}else{var r=S()?D(L()[b()]||""):"";if(r){var s=r.split("=")[0];s&&-1==e.indexOf(s+"=")&&(e=Lampa.Utils.addUrlComponent(e,r))}}return e}var G=v.replace("http://","").replace("https://",""),W=!1;function H(e,t){function n(){window.nwsClient&&window.nwsClient[G]&&window.nwsClient[G]._shouldReconnect?t&&t():(window.nwsClient||(window.nwsClient={}),window.nwsClient[G]&&window.nwsClient[G].socket&&window.nwsClient[G].socket.close(),window.nwsClient[G]=new NativeWsClient(e.nws,{autoReconnect:!0}),window.nwsClient[G].on("Connected",(function(){window.rch_nws[G].Registry(window.nwsClient[G],(function(){t&&t()}))})),window.nwsClient[G].on("Error",(function(e){console.log("BWA NWS Error:",e)})),window.nwsClient[G].connect())}window.rch_nws||(window.rch_nws={}),window.rch_nws[G]||(window.rch_nws[G]={type:Lampa.Platform.is("android")?"apk":Lampa.Platform.is("tizen")?"cors":"web",startTypeInvoke:!1,rchRegistry:!1,apkVersion:0}),window.rch_nws[G].Registry=function(e,t){e.invoke("RchRegistry",JSON.stringify({version:151,host:location.host,rchtype:window.rch_nws[G].type||"web",apkVersion:0,player:Lampa.Storage.field("player"),account_email:Lampa.Storage.get("account_email",""),unic_id:Lampa.Storage.get("lampac_unic_id",""),profile_id:Lampa.Storage.get("lampac_profile_id",""),token:""})),e._shouldReconnect&&window.rch_nws[G].rchRegistry?t&&t():(window.rch_nws[G].rchRegistry=!0,e.on("RchRegistry",(function(e){!0,t&&t()})),e.on("RchClient",(function(t,n,a,i,o){var r=new Lampa.Reguest;function s(n){(Lampa.Arrays.isObject(n)||Lampa.Arrays.isArray(n))&&(n=JSON.stringify(n)),function(n,a){$.ajax({url:"http://"+v+"/rch/"+n+"?id="+t,type:"POST",data:a,async:!0,cache:!1,contentType:!1,processData:!1,success:function(){},error:function(){e.invoke("RchResult",t,"")}})}("result",n)}"ping"==n?s("pong"):r.native(n,s,(function(){s("")}),a,{dataType:"text",timeout:8e3,headers:i,returnHeaders:o})})),e.on("Connected",(function(e){window.rch_nws[G].connectionId=e,!0})))},"undefined"==typeof NativeWsClient?Lampa.Utils.putScript(["http://"+v+"/js/nws-client-es5.js?v18112025"],(function(){}),!1,(function(){n()}),!0):n()}function K(e,t){return!(!e||!e.rch)&&(H(e,(function(){setTimeout((function(){t&&t()}),500)})),!0)}var J=function(){function n(e){t(this,n),this.object=e,this.network=new Lampa.Reguest,this.voiceSave=new o(e)}return a(n,[{key:"externalids",value:function(){var e=this;return new Promise((function(t,n){if(e.object.movie.imdb_id&&e.object.movie.kinopoisk_id)t();else{var a=[];a.push("id="+e.object.movie.id),a.push("serial="+(e.object.movie.name?1:0)),e.object.movie.imdb_id&&a.push("imdb_id="+(e.object.movie.imdb_id||"")),e.object.movie.kinopoisk_id&&a.push("kinopoisk_id="+(e.object.movie.kinopoisk_id||""));var i=Lampa.Utils.protocol()+B.stream+"/externalids?"+a.join("&");e.network.timeout(1e4),e.network.silent(U(i),(function(n){for(var a in n)e.object.movie[a]=n[a];t()}),(function(){t()}))}}))}},{key:"requestParams",value:function(e){var t=[],n=this.object,a=n.movie.source||"tmdb";return t.push("id="+n.movie.id),n.movie.imdb_id&&t.push("imdb_id="+(n.movie.imdb_id||"")),n.movie.kinopoisk_id&&t.push("kinopoisk_id="+(n.movie.kinopoisk_id||"")),t.push("title="+encodeURIComponent(n.clarification?n.search:n.movie.title||n.movie.name)),t.push("original_title="+encodeURIComponent(n.movie.original_title||n.movie.original_name)),t.push("serial="+(n.movie.name?1:0)),t.push("original_language="+(n.movie.original_language||"")),t.push("year="+((n.movie.release_date||n.movie.first_air_date||"0000")+"").slice(0,4)),t.push("source="+a),t.push("clarification="+(n.clarification?1:0)),t.push("rjson=true"),Lampa.Storage.get("account_email","")&&t.push("cub_id="+Lampa.Utils.hash(Lampa.Storage.get("account_email",""))),e+(e.indexOf("?")>=0?"&":"?")+t.join("&")}},{key:"query",value:function(e){var t=this;return new Promise((function(n,a){var i,o=[].concat(B.sources),s=new r(o.length),l=!1;function u(){l||Lampa.Noty.show(Lampa.Lang.translate("huyfix_wait"))}u(),i=setInterval(u,2e3),s.onComplite=function(e){l=!0,clearInterval(i);var t=[],r=700;o.forEach((function(n){var a=e[n];if(a)if(a.error)r=a.error;else if(a.accsdb)r=600;else if("similar"!=a.type&&a.data){var i=a.balanser||a._source_id||n;a.voice&&Lampa.Arrays.isArray(a.voice)&&a.voice.forEach((function(e){e.source_name=i})),a.data&&Lampa.Arrays.isArray(a.data)&&a.data.forEach((function(e){e.source_name=i})),a.source_name=i,t.push(a.voice?a:a.data)}})),t.length?n(t):a(r)},o.forEach((function(n){t.source(n,e.season).then((function(e){if(e.voice&&e.data&&e.data[0]&&e.data[0].quality){var t=0;for(var a in e.data[0].quality){var i=parseInt(a);i>t&&(t=i)}t>0&&e.voice.forEach((function(e){(!e.maxquality||parseInt(e.maxquality)<t)&&(e.maxquality=t+"p")}))}e._source_id=n,s.append(n,e)})).catch((function(e){s.append(n,{error:e})}))}))}))}},{key:"source",value:function(e,t){var n=this;return new Promise((function(a,i){var o=function(e){for(var t=0;t<_.length;t++){var n=_[t],a=Lampa.Arrays.isArray(n.id)?n.id:[n.id];if(-1!==a.indexOf(e))return a}return[e]}(e),r=0,s=function(){if(r>=o.length)i(400);else{var e=o[r],l=function(o,u){var c=o?"/lite/":"/",d=Lampa.Utils.protocol()+B.stream+c+e,f=n.requestParams(U(d));t&&(f+="&s="+t),n.network.timeout(1e4),n.network.silent(f,(function(e){var t;try{t=JSON.parse(e)}catch(e){}t?t.rch&&P()&&!u?K(t,(function(){l(o,!0)})):"disable"===t||t.disable||t.error&&!t.data?(r++,s()):a(t):"disable"===e?(r++,s()):i(500)}),(function(){o?l(!1,u):(r++,s())}),!1,{dataType:"text"})},u=-1==B.nolite.indexOf(e);l(u,!1)}};s()}))}},{key:"links",value:function(e){var t=this;return new Promise((function(n,a){var i=[],o=[];e.forEach((function(e){i=i.concat(e.filter((function(e){return"call"==e.method}))),o=o.concat(e.filter((function(e){return"play"==e.method})))}));var s=new r(i.length);s.onComplite=function(){n(N.renameTranslate(o))};var l=function(e,n){t.network.timeout(1e4),t.network.silent(U(e.url),(function(t){if(t.rch&&P()&&!n)K(t,(function(){l(e,!0)}));else{var a=t;if(!a.quality&&a.url){a.quality={};var i=a.url;-1!==i.indexOf(" or ")&&(i=i.split(" or ")[0]),a.quality.auto=a.url}a.quality&&Object.keys(a.quality).length>0&&(a.details=e.details||a.details||"no details",a.translate=e.translate||a.translate||"no translate",a.source_name=e.source_name,o.push(a)),s.next()}}),(function(e){s.error()}))};i.forEach((function(e){l(e,!1)})),0==i.length&&n(N.renameTranslate(o))}))}},{key:"m3u",value:function(e){var t=this;return new Promise((function(n,a){var i=[],o=Lampa.Storage.field("video_quality_default"),r=function(t){parseInt(t)<=o&&[e.quality[t].url].concat(e.quality[t].reserve).forEach((function(n){i.push({quality:t,name:e.name,url:n})}))};for(var s in e.quality)r(s);t.network.silent(Lampa.Utils.protocol()+B.stream+"/m3u/add",(function(e){n(Lampa.Utils.protocol()+B.stream+e.url)}),(function(e,t){a(400)}),{playlist:i})}))}},{key:"flows",value:function(e){var t=[],n=Lampa.Storage.field("video_quality_default"),a=function(n){var a=[e[n].url].concat(e[n].reserve),i=parseInt(n);a.forEach((function(e){t.push({int:i,label:i>1440?"4K":i>=1440?"2K":i>=1080?"FHD":i>=720?"HD":"",quality:n,url:e})}))};for(var i in e)a(i);var o=t.find((function(e){return e.int==n}));return o&&(o.selected=!0),t}},{key:"movie",value:function(e){var t=this;return new Promise((function(n,a){t.externalids().then((function(){return t.query(e)})).then((function(e){var i=[];e.forEach((function(e){var t=N.filterTranslate(e);t.length&&(i=i.concat(t))}));new Promise((function(e){var n=i.filter((function(e){return"call"==e.method}));if(0!=n.length){var a=new r(n.length),o=[];a.onComplite=function(){i=i.filter((function(e){return"call"!=e.method||-1!==o.indexOf(e)})),e()},n.forEach((function(e){!function n(i,r){t.network.timeout(-1!==(e.source_name||"").toLowerCase().indexOf("mirage")?1e4:5e3),t.network.silent(U(i),(function(t){if(t.rch&&P()&&!r)K(t,(function(){n(i,!0)}));else{var s=t;s&&(s.url||s.quality&&Object.keys(s.quality).length>0)&&o.push(e),a.next()}}),(function(){a.next()}))}(e.url,!1)}))}else e()})).then((function(){if(i.forEach((function(e){e.maxquality=e.maxquality||"1080p";var t=e.translate.match(/\[(.*?)\]/);t&&(t=t[1].split(",").map((function(e){return e.trim()})),e.lang=(t.map((function(e){return e.toLowerCase()})).find((function(e){return"ru"==e||"uk"==e||"rus"==e||"ukr"==e||"укр"==e}))||"").toUpperCase(),e.lang="RUS"==e.lang?"RU":"UKR"==e.lang?"UA":e.lang,"RU"==e.lang&&"ru"==N.region()&&(e.lang=""),e.translate=t.find((function(e){return e.length>5}))||e.translate)})),0==i.length)throw new Error("No data");N.renameTranslate(i),n({sources:e,translates:i})})).catch((function(e){a(e)}))})).catch(a)}))}},{key:"tv",value:function(t){var n=this;return new Promise((function(a,o){n.externalids().then((function(){n.query(t).then((function(t){n.voice(t).then((function(n){a(function(t){for(var n=1;n<arguments.length;n++){var a,o=null!==(a=arguments[n])&&void 0!==a?a:{};n%2?e(Object(o),!0).forEach((function(e){i(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):e(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}({sources:t},n))})).catch(o)})).catch(o)}))}))}},{key:"voice",value:function(e){var t=this;return new Promise((function(n,a){var i=t.voiceSave.get(),o=[],s=B.filter_tv,l=[],u=function(e,t){e.data.forEach((function(e){e.translate_name=t}))},c=function e(n,a){return new Promise((function(i,o){t.network.timeout(1e4),t.network.silent(U(n.url),(function(r){var s,l=r;if("string"==typeof r)if(-1!==r.indexOf("<div")||-1!==r.indexOf("data-json"))s={data:[]},$(r).find("[data-json]").each((function(){try{var e=$(this).attr("data-json"),t=JSON.parse(e);"play"===t.method&&t.url&&s.data.push(t)}catch(e){}})),l=s;else try{l=JSON.parse(r)}catch(e){l={}}if(l.rch&&P()&&!a)K(l,(function(){e(n,!0).then(i).catch(o)}));else{if(!l.data||0===l.data.length)return void o("no data");if(l.data.every((function(e){return"call"===e.method}))&&l.data.length>0){var c=l.data[0];t.network.timeout(-1!==(n.source_name||"").toLowerCase().indexOf("mirage")?1e4:5e3),t.network.silent(U(c.url),(function(e){var t=e;if("string"==typeof e)try{t=JSON.parse(e)}catch(e){t={}}t.quality&&0!==Object.keys(t.quality).length?(u(l,N.voice(n)),i(l.data)):o("no quality in call")}),(function(e){o("call network error")}),!1,{dataType:"text"})}else u(l,N.voice(n)),i(l.data)}}),(function(e){o(e)}),!1,{dataType:"text"})}))};e.forEach((function(e){if(e.voice&&Lampa.Arrays.isArray(e.voice)){e.voice=N.filterTranslate(e.voice);var t=e.source_name||e.balanser||"";e.voice.forEach((function(e){e.source_name=e.source_name||t})),l=l.concat(e.voice.filter((function(e){return 0==s.filter((function(t){return N.voice(e).toLowerCase().indexOf(t)>=0})).length})))}})),i||(i=N.voice(l[0])),l.sort((function(e,t){return N.voice(e).toLowerCase().localeCompare(N.voice(t).toLowerCase())}));var d=[],f=0,m=l.length;0!==m?l.forEach((function(e){c(e,!1).then((function(t){if(d.push(e),++f===m){if(0===d.length)return void a(700);var s=d.filter((function(e){return N.compareVoice(e.name,i)}));0===s.length&&(s=[d[0]]);var l=new r(s.length);l.onComplite=function(){n({translates:d,plays:o})},s.forEach((function(e){c(e,!1).then((function(e){o=o.concat(e),l.next()})).catch(l.error.bind(l))}))}})).catch((function(e){if(++f===m){if(0===d.length)return void a(700);var t=d.filter((function(e){return N.compareVoice(e.name,i)}));0===t.length&&(t=[d[0]]);var s=new r(t.length);s.onComplite=function(){n({translates:d,plays:o})},t.forEach((function(e){c(e,!1).then((function(e){o=o.concat(e),s.next()})).catch(s.error.bind(s))}))}}))})):a(700)}))}},{key:"error",value:function(e){var t=Lampa.Controller.enabled().name,n=Lampa.Lang.translate("huyfix_no_content"),a=$('<div class="connect-broken">\n\t\t\t\t\t\t\t\t\t<div class="connect-broken__title">'.concat(Lampa.Lang.translate("huyfix_error_title"),'</div>\n\t\t\t\t\t\t\t\t\t<div class="connect-broken__text">').concat(n,'</div>\n\t\t\t\t\t\t\t\t\t<div class="connect-broken__footer">\n\t\t\t\t\t\t\t\t\t\t<div class="selector simple-button">').concat(Lampa.Lang.translate("huyfix_close"),"</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>"));a.find(".selector").on("hover:enter",(function(){Lampa.Controller.back()})),Lampa.Modal.open({title:"",html:a,onBack:function(){Lampa.Modal.close(),Lampa.Controller.toggle(t)}})}}]),n}();function Q(e,t){var n=0,a=0;e.forEach((function(e,t){!e.quality&&e.url&&-1!==e.url.indexOf(".m3u8")&&n++})),0!==n?e.forEach((function(i,o){if(!i.quality&&i.url&&-1!==i.url.indexOf(".m3u8")){var r=new Lampa.Reguest;r.timeout(5e3),r.native(i.url,(function(o){if("string"==typeof o&&-1!==o.indexOf("#EXT-X-STREAM-INF")){var r=function(e,t){for(var n={},a=e.split("\n"),i=null,o=0;o<a.length;o++){var r=a[o].trim();if(0===r.indexOf("#EXT-X-STREAM-INF")){var s=r.match(/RESOLUTION=(\d+)x(\d+)/i);if(s)i=parseInt(s[2]);else{var l=r.match(/BANDWIDTH=(\d+)/i);if(l){var u=parseInt(l[1]);i=u>4e6?1080:u>2e6?720:u>1e6?480:u>5e5?360:240}}}else if(i&&r&&0!==r.indexOf("#")){var c=r;if(0!==c.indexOf("http")){var d=t.split("/");d.pop(),c=d.join("/")+"/"+c}var f=i+"p";n[f]||(n[f]=c),i=null}}return n}(o,i.url);Object.keys(r).length>0&&(i.quality=r)}++a>=n&&t(e)}),(function(){++a>=n&&t(e)}),!1,{dataType:"text"})}})):t(e)}var X=function(){function e(n){var a=this;t(this,e),this.object=n,this.extract=new J(n),this.voice=new o(n),this.on_error_timer=null;Lampa.Player.listener.follow("destroy",(function e(){Lampa.Player.listener.remove("close",e),clearTimeout(a.on_error_timer)}))}return a(e,[{key:"getQuality",value:function(e){var t=this,n={};e.forEach((function(e,a){var i=e.quality;if(!i||"object"!==_typeof(i)){if(!e.url)return;i={auto:e.url}}var o=function(e){var a=parseInt(e),o=t.getSplitLinks(i[e]);n[e]?n[e].reserve=n[e].reserve.concat(o):n[e]={label:a>1440?"4K":a>=1440?"2K":a>=1080?"FHD":a>=720?"HD":"",url:o[0],reserve:o.length>1?o.slice(1):[],used:[],error:[],trigger:function(){t.setFlowsForQuality(Lampa.Player.playdata())}}};for(var r in i)o(r)}));var a=Lampa.Arrays.getKeys(n),i={};return a.sort((function(e,t){var n=parseInt((e+"").replace(/[^0-9]/g,""))||0,a=parseInt((t+"").replace(/[^0-9]/g,""))||0;return 0===n&&0===a?(e+"").localeCompare(t+""):0===n?1:0===a?-1:a-n})),a.forEach((function(e){var t=parseInt((e+"").replace(/[^0-9]/g,""))||0;t>0&&!n[e].label&&(n[e].label=t>1440?"4K":t>=1440?"2K":t>=1080?"FHD":t>=720?"HD":""),i[e]=n[e]})),i}},{key:"getSplitLinks",value:function(e){return"string"!=typeof e?e&&e.url?[e.url]:[String(e)]:e.split(" or ")}},{key:"getSelectedQuality",value:function(e){var t=null,n=e.url,a=e.quality;if(e.quality_switched){for(var i in a)if(i==e.quality_switched){t=a[i];break}}else for(var i in a){var o=a[i];if(o.url==n||o.reserve.indexOf(n)>=0){t=o;break}}if(!t)for(var i in a){t=a[i];break}return t}},{key:"getQualityLevelDown",value:function(e){var t,n,a=this.getSelectedQuality(e);for(var i in e.quality)if(a==e.quality[i]){t=i;break}if(t){var o=Lampa.Arrays.getKeys(e.quality);o.sort((function(e,t){return parseInt(t)-parseInt(e)})),o.forEach((function(e){parseInt(e)<parseInt(t)&&!n&&parseInt(e)>360&&(n=e)}))}return n}},{key:"getReserveQuality",value:function(e){var t=this.getSelectedQuality(e),n="";return t&&(t.error.push(Lampa.Manifest.app_digital>=236?e.url:t.url),t.reserve.forEach((function(e){-1!=t.used.indexOf(e)||n||(n=e,t.used.push(e))}))),n}},{key:"getPlayData",value:function(e){var t=Lampa.Utils.hash(e.season?[e.season,e.season>10?":":"",e.episode,this.object.movie.original_title].join(""):this.object.movie.original_title),n=this.getQuality(e.quality);return{title:this.object.movie.title||this.object.movie.name,url:Lampa.Player.getUrlQuality(n),quality:n,timeline:Lampa.Timeline.view(t),translate_name:e.translate,card:this.object.movie}}},{key:"getNextVoice",value:function(e,t,n){var a=this.getSelectedQuality(e);if(a&&(0==a.reserve.length||a.used.length==a.reserve.length)){var i=this.getQualityLevelDown(e);i?(e.quality_switched=i,a=this.getSelectedQuality(e),Lampa.Arrays.remove(a.reserve,a.url),Lampa.Arrays.insert(a.reserve,0,a.url)):a=null}a?(e.url=this.getReserveQuality(e),n(e.url||"nofound"),this.setFlowsForQuality(e)):N.modalChoiceTranstale({from:t.find((function(e){return e.selected})).name,voicelist:t})}},{key:"setFlowsForQuality",value:function(e){if(e&&e.quality){var t=Object.keys(e.quality);if(1!==t.length||"auto"!==t[0]){var n=this.getSelectedQuality(e);if(n){r=[];var a=[n.url].concat(n.reserve.filter((function(e){return e!==n.url}))).filter((function(e){return-1==n.error.indexOf(e)}));a.length>0&&a.forEach((function(e,t){r.push({title:Lampa.Lang.translate("huyfix_stream")+" "+(t+1),subtitle:Lampa.Utils.shortText(e,35),url:e,selected:e==n.url})})),Lampa.PlayerPanel.setFlows(!!r.length&&r)}}else{var i=e.quality.auto,o=i.url||i;if("string"==typeof o&&o){var r=[{title:Lampa.Lang.translate("huyfix_stream")+" 1",subtitle:Lampa.Utils.shortText(o,35),url:o,selected:!0}];Lampa.PlayerPanel.setFlows(r)}}}}},{key:"movie",value:function(e){var t=this,n=N.player(),a=F()||"inner"!=n;e.translates.sort((function(e,t){var n=parseInt(e.maxquality)||0,a=parseInt(t.maxquality)||0;if(a!==n)return a-n;var i=B.filter_db.filter((function(t){return e.translate.toLowerCase().indexOf(t.toLowerCase())>=0})).length,o=B.filter_db.filter((function(e){return t.translate.toLowerCase().indexOf(e.toLowerCase())>=0})).length;return i&&!o?-1:!i&&o?1:0}));var i=this.voice.get();i||(i=N.voice(e.translates[0]));var o=e.translates.filter((function(e){return N.compareVoice(N.voice(e),i)})),r=Lampa.Utils.hash(this.object.movie.original_title);if(a){var s={};e.translates.forEach((function(e){var t=N.voice(e);s[t]||(s[t]=[]),s[t].push(e)}));var l=Object.keys(s),u={},c=0;l.forEach((function(e){t.extract.links([s[e]]).then((function(n){if(n.length>0&&(u[e]=s[e]),++c===l.length){var a=[];for(var o in u)a=a.concat(u[o]);if(0===a.length)return t.extract.error(700);N.selectChoiceTranstale(a,i,(function(e){t.voice.set(N.voice(e)),t.extract.links([a.filter((function(t){return N.compareVoice(N.voice(t),N.voice(e))}))]).then((function(e){if(0==e.length)return Lampa.Bell.push({text:Lampa.Lang.translate("huyfix_no_links"),time:5e3});var n=t.getQuality(e),a=e.find((function(e){return e.subtitles})),i=t.extract.flows(n);N.selectChoiceFlow(i,(function(e){var n={title:t.object.movie.title||t.object.movie.name,url:e.url,timeline:Lampa.Timeline.view(r),subtitles:!!a&&a.subtitles};Lampa.Player.play(n)}))})).catch((function(e){t.extract.error(e)}))}))}})).catch((function(e){if(++c===l.length){var n=[];for(var a in u)n=n.concat(u[a]);if(0===n.length)return t.extract.error(700)}}))}))}else"inner"==n&&t.extract.links([o]).then((function(n){Q(n,(function(n){Lampa.Player.opened()&&Lampa.Player.close();var a=[],s=t.getQuality(n),l=n.find((function(e){return e.subtitles})),u={};n.forEach((function(e){var t=e.translate_name||e.translate||"",n=e.source_name||"";t&&n&&(u[t]||(u[t]=[]),-1===u[t].indexOf(n)&&u[t].push(n))}));var c={};o.forEach((function(e){var t=e.translate,n=e.source_name||"";c[t]||(c[t]=[]),n&&-1===c[t].indexOf(n)&&c[t].push(n)}));var d={};for(var f in e.translates.forEach((function(e){var t=e.translate;d[t]||(d[t]={item:e,sources:[],maxquality:0});var n=e.source_name||"",a=!1;n&&-1===d[t].sources.indexOf(n)&&(N.compareVoice(t,i)?u[t]&&-1!==u[t].indexOf(n)&&(a=!0):a=!0),a&&d[t].sources.push(n);var o=parseInt(e.maxquality)||0;o>d[t].maxquality&&(d[t].maxquality=o)})),d){var m=d[f],h=(m.item,[]);m.sources.length>0&&h.push(m.sources.join(", ")),m.maxquality>0&&h.push(m.maxquality+"p"),a.push({selected:N.compareVoice(i,f),name:f,title:f,subtitle:h.join(" • "),onSelect:function(){t.voice.set(this.name),Lampa.Player.loading(!0),t.movie(e)}})}a.find((function(e){return e.selected}))||(a[0].selected=!0);var p={title:t.object.movie.title||t.object.movie.name,url:n.length?Lampa.Player.getUrlQuality(s):"nofound",quality:s,timeline:Lampa.Timeline.view(r),subtitles:!!l&&l.subtitles,card:t.object.movie,voiceovers:a,error:function(e,n){t.on_error_timer=setTimeout((function(){t.getNextVoice(e,a,n)}),2e3)}};Lampa.Player.runas("inner"),Lampa.Player.play(p),Lampa.Player.playlist([]),t.setFlowsForQuality(p)}))}))}},{key:"tv",value:function(e,t,n){var a=this,i=[],o=[],r=this.voice.get();Lampa.Controller.toggle("content"),N.sortDUBTranstale(e.translates);var s={};for(var l in e.translates.forEach((function(e){var t=e.name;s[t]||(s[t]={item:e,sources:[],maxquality:0});var n=e.source_name||"";n&&-1===s[t].sources.indexOf(n)&&s[t].sources.push(n);var a=parseInt(e.maxquality)||0;a>s[t].maxquality&&(s[t].maxquality=a)})),s){var u=s[l];u.item;!function(i,s,l){var u=[];s.sources.length>0&&u.push(s.sources.join(", ")),s.maxquality>0&&u.push(s.maxquality+"p"),o.push({name:i,title:i,subtitle:u.join(" • "),selected:N.compareVoice(i,r),onSelect:function(){a.voice.set(i),Lampa.Player.loading(!0),a.extract.voice(e.sources).then((function(i){i.sources=e.sources,a.tv(i,t,n)})).catch((function(e){})).finally((function(){Lampa.Player.loading(!1)}))}})}(l,u)}o.find((function(e){return e.selected}))||(o[0].selected=!0),t.forEach((function(t){if(e.plays.find((function(e){return e.e==t.number}))){var r={number:t.number,title:t.title,timeline:t.timeline,launch_player:"inner",url:function(n){var i=N.player();F()||"inner"!=i?N.selectChoiceTranstale(e.translates,N.voice(o.find((function(e){return e.selected}))),(function(n){a.voice.set(N.voice(n)),a.extract.voice(e.sources).then((function(e){return a.extract.links([e.plays.filter((function(e){return e.e==t.number}))])})).then((function(e){if(0==e.length)throw new Error(700);var n=a.getQuality(e),i=e.find((function(e){return e.subtitles})),o=a.extract.flows(n);N.selectChoiceFlow(o,(function(e){var n={title:t.title,url:e.url,timeline:t.timeline,subtitles:!!i&&i.subtitles};t.mark(),Lampa.Player.play(n)}))})).catch((function(e){a.extract.error(e)}))})):"inner"==i&&(Lampa.Player.loading(!0),a.extract.links([e.plays.filter((function(e){return e.e==t.number}))]).then((function(e){0==e.length?(r.url="nofound",n()):(r.quality=a.getQuality(e),r.url=Lampa.Player.getUrlQuality(r.quality),n(),setTimeout((function(){a.setFlowsForQuality({url:"string"==typeof r.url?r.url:"",quality:r.quality,quality_switched:null})}),100))})).catch((function(){r.url="nofound",n()})).finally((function(){Lampa.Player.loading(!1)})))},card:a.object.movie,voiceovers:o,callback:function(){t.mark(),n=t},error:function(e,t){a.on_error_timer=setTimeout((function(){a.getNextVoice(e,o,t)}),2e3)}};i.push(r)}}));var c=i.find((function(e){return e.number==n.number}));if(!c)return N.modalChoiceTranstale({from:o.find((function(e){return e.selected})).name,voicelist:o});c.url((function(){Lampa.Player.opened()&&Lampa.Player.close(),Lampa.Player.runas("inner"),Lampa.Player.play(c),Lampa.Player.playlist(i),c.quality&&Object.keys(c.quality).length>0&&a.setFlowsForQuality({url:"string"==typeof c.url?c.url:"",quality:c.quality,quality_switched:null})}))}}]),e}(),Z=function(){function e(n){t(this,e);var a=this;if(this.object=n,P()){if(!O())return void Lampa.Noty.show("BWA код не указан. Укажите его в настройках.");!function(e){var t=O();if(t)if(W)e&&e(!0);else{var n="http://"+v+"/online/js/"+t;Lampa.Utils.putScriptAsync([n],(function(){W=!0,e&&e(!0)}))}else e&&e(!1)}((function(e){a.startPlay()}))}else{if(!S())return void Lampa.Noty.show("Сервер не указан. Добавьте сервер в настройках.");this.startPlay()}}return a(e,[{key:"startPlay",value:function(){this.object.movie.name?this.tv():this.movie()}},{key:"movie",value:function(){var e=this,t=new J(this.object),n=new X(this.object);t.movie({movie:this.object.movie,type:"movie"}).then((function(t){Lampa.Favorite.add("history",e.object.movie,100),n.movie(t)})).catch((function(e){t.error(e)}))}},{key:"tv",value:function(){Lampa.Activity.push({url:"",title:"",component:"episodes",movie:this.object.movie,page:1})}}]),e}();function Y(e){var t,n=new Lampa.Explorer(e),a=new Lampa.Filter(e),i=new Lampa.Scroll({mask:!0,over:!0}),o={season:1},r=e.movie.number_of_seasons||1,l=!1,u=!1;this.create=function(){var t=this;this.getChoice(),n.appendFiles(i.render()),n.appendHead(a.render()),i.body().addClass("torrent-list mapping--list"),n.render().find(".filter--search, .filter--sort").remove(),i.minus(n.render().find(".explorer__files-head")),this.activity.loader(!0);var c=e.movie.id,d=e.movie.imdb_id,f=e.movie.tvdb_id,m=s.getSeasonsCount(c);function h(){l||Lampa.Api.seasons(e.movie,[1],(function(e){if(!l){if(e[1]&&e[1].seasons_count&&e[1].seasons_count>r&&(r=e[1].seasons_count),!u){var n=s.getSeasonsCount(c);n&&n>r&&(r=n)}l=!0,t.filter(),t.selected(),t.activity.loader(!1),e[1]&&e[1].episodes&&e[1].episodes.length&&1===o.season?t.draw(e[1].episodes):t.load()}}))}return m?(r=m,u=!0,h()):(s.fetch(c,d,f,(function(e){u=!0,e&&e>r&&(r=e),h()})),setTimeout((function(){l||h()}),3e3)),this.activity.toggle(),this.render()},this.setChoice=function(t){o.season=t;var n=Lampa.Storage.cache("season_choice","{}",1e3);n[e.movie.id]=t,Lampa.Storage.set("season_choice",n)},this.getChoice=function(){var t=Lampa.Storage.get("season_choice","{}");t[e.movie.id]&&(o.season=Math.max(1,t[e.movie.id]),l&&o.season>r&&(o.season=r))},this.filter=function(){var e=this;a.addButtonBack(),a.onSelect=function(t,n){e.setChoice(n.season),e.selected(),Lampa.Controller.toggle("content"),e.load()},a.onBack=function(){e.start()}},this.selected=function(){var e=[],t=[];for(var n in o)"season"==n&&e.push(Lampa.Lang.translate("torrent_serial_season")+": "+o[n]);for(var i=0;i<r;i++)t.push({title:Lampa.Lang.translate("torrent_serial_season")+" "+(i+1),season:i+1,selected:o.season==i+1});a.set("filter",t),a.chosen("filter",e)},this.load=function(){var n=this;this.activity.loader(!0);var a=o.season;Lampa.Api.clear(),Lampa.Api.seasons(e.movie,[a],(function(e){t=!1,i.clear(),i.reset(),e[a]&&e[a].episodes&&e[a].episodes.length?n.draw(e[a].episodes):n.empty(),n.activity.loader(!1)}))},this.empty=function(){var e=Lampa.Template.get("empty_filter"),t=$('<div class="simple-button selector"><span>'+Lampa.Lang.translate("filter_clarify")+"</span></div>");t.on("hover:enter",(function(){a.render().find(".filter--filter").trigger("hover:enter")})),e.find(".empty-filter__title").remove(),e.find(".empty-filter__buttons").removeClass("hide").append(t),i.append(e),Lampa.Controller.enable("content")},this.draw=function(n){n.forEach((function(a,r){var s=a.episode_number||r+1,l=Lampa.Utils.hash([o.season,o.season>10?":":"",s,e.movie.original_title].join("")),u=[],c=new Date((a.air_date+"").replace(/-/g,"/")),d=Date.now(),f=a.air_date?Math.round((c.getTime()-d)/864e5):1,m=Lampa.Lang.translate("full_episode_days_left")+": "+(a.air_date?f:"- -");a.timeline=Lampa.Timeline.view(l),a.time=Lampa.Utils.secondsToTime(60*a.runtime,!0),a.title=a.name||Lampa.Lang.translate("torrent_serial_episode")+" "+s,a.quality=f>0?m:"",a.number=s,a.vote_average&&u.push(Lampa.Template.get("season_episode_rate",{rate:parseFloat(a.vote_average+"").toFixed(1)},!0)),a.air_date&&u.push(Lampa.Utils.parseTime(a.air_date).full),a.info=u.length?u.map((function(e){return"<span>"+e+"</span>"})).join('<span class="season-episode-split">●</span>'):"";var h=Lampa.Template.get("season_episode",a),p=h.find(".season-episode__loader"),v=h.find(".season-episode__img"),y=function(e){h.find(".season-episode__viewed").remove(),(Boolean(a.timeline.percent)||e)&&h.find(".season-episode__img").append('<div class="season-episode__viewed">'+Lampa.Template.get("icon_viewed",{},!0)+"</div>")};a.mark=function(){t=h[0],y(!0)},h.find(".season-episode__timeline").append(Lampa.Timeline.render(a.timeline)),f>0?h.css("opacity","0.5"):(y(),Boolean(a.timeline.percent)&&(t=h[0]),h.on("hover:enter",(function(){var r=new J(e),l=new X(e);r.tv({movie:e.movie,season:o.season,episode:s,type:"episode"}).then((function(o){Lampa.Favorite.add("history",e.movie,100),l.tv(o,n,a),a.mark(),Lampa.Player.callback((function(){i.update($(t),!0),Lampa.Controller.toggle("content")}))})).catch((function(e){r.error(e)}))}))),h.on("hover:focus",(function(e){t=e.target,i.update($(e.target),!0)})).on("visible",(function(){var e=h.find("img")[0];e.onerror=function(){e.src="./img/img_broken.svg"},e.onload=function(){v.addClass("season-episode__img--loaded"),p.remove(),v.append('<div class="season-episode__episode-number">'+("0"+s).slice(-2)+"</div>")},a.still_path?e.src=Lampa.TMDB.image("t/p/w300"+a.still_path):a.img?e.src=a.img:(p.remove(),v.append('<div class="season-episode__episode-number">'+("0"+s).slice(-2)+"</div>"))})).on("hover:hover hover:touch",(function(e){t=e.target,Navigator.focused(t)})),i.append(h)})),t&&i.update($(t),!0),Lampa.Layer.visible(i.render(!0)),Lampa.Controller.enable("content")},this.start=function(){Lampa.Activity.active().activity===this.activity&&(Lampa.Background.immediately(Lampa.Utils.cardImgBackgroundBlur(e.movie)),Lampa.Controller.add("content",{toggle:function(){Lampa.Controller.collectionSet(i.render(),n.render()),Lampa.Controller.collectionFocus(t||!1,i.render())},left:function(){n.toggle()},right:function(){a.show(Lampa.Lang.translate("title_filter"),"filter")},up:function(){Navigator.canmove("up")?Navigator.move("up"):Lampa.Controller.toggle("head")},down:function(){Navigator.canmove("down")&&Navigator.move("down")},back:function(){Lampa.Activity.backward()}}),Lampa.Controller.toggle("content"))},this.pause=function(){},this.stop=function(){},this.render=function(){return n.render()},this.destroy=function(){i.destroy(),a.destroy(),n.destroy();try{Lampa.Api.clear()}catch(e){}}}function ee(e){Lampa.Input.edit({title:Lampa.Lang.translate("huyfix_server_address"),value:"",placeholder:"192.168.1.1:9118",nosave:!0,free:!0,nomic:!0},(function(t){t&&w(t)&&k(L().length-1);e&&e(t)}))}function te(e){var t=P()?Lampa.Utils.protocol()+v:S();if(t){var n=t+"/lite/events?life=true&id=76600&imdb_id=tt1630029&kinopoisk_id=505898&serial=0&title=Avatar&original_title=Avatar&original_language=en&year=2022&source=tmdb&clarification=0&similar=false&rchtype=&uid=guest";n=U(n);var a,i=0,o="",r=[],s=!1,l=!1;c(),a=setInterval(c,2e3);var u=e;e=function(e,t){l=!0,clearInterval(a),u(e,t)},function a(){var l=new Lampa.Reguest;l.timeout(5e3);var u=o?t+"/lifeevents?memkey="+o+"&id=76600&imdb_id=tt1630029&kinopoisk_id=505898&serial=0&title=Avatar&original_title=Avatar&original_language=en&year=2022&source=tmdb&clarification=0&similar=false&rchtype=&uid=guest":n;u=U(u),l.silent(u,(function(t){var n;try{n="string"==typeof t?JSON.parse(t):t}catch(e){n=t}if(n&&n.rch&&P()&&!s)return s=!0,void K(n,(function(){i=0,o="",setTimeout(a,500)}));var l=n&&n.online?n.online:Lampa.Arrays.isArray(n)?n:[];if(n&&n.accsdb)e(null,Lampa.Lang.translate("huyfix_access_denied"));else{n&&n.memkey&&(o=n.memkey);var u=function(e){var t=[];return e&&Lampa.Arrays.isArray(e)?(e.forEach((function(e){if(!1!==e.show){var n=(e.balanser||"").toLowerCase();if(n){for(var a=!1,i=0;i<_.length;i++){for(var o=_[i],r=Lampa.Arrays.isArray(o.id)?o.id:[o.id],s=0;s<r.length;s++)if(r[s].toLowerCase()===n){-1===t.indexOf(r[0])&&t.push(r[0]),a=!0;break}if(a)break}a||-1!==t.indexOf(n)||t.push(n)}}})),t):t}(l);u.forEach((function(e){-1===r.indexOf(e)&&r.push(e)})),n&&n.ready?e(r.length>0?r:null,0===r.length?Lampa.Lang.translate("huyfix_sources_not_found"):null):Lampa.Arrays.isArray(n)&&r.length>0?e(r,null):++i>=20?e(r.length>0?r:null,0===r.length?Lampa.Lang.translate("huyfix_sources_not_found"):null):setTimeout(a,1e3)}}),(function(t){e(null,Lampa.Lang.translate("huyfix_connection_error"))}),!1,{dataType:"text"})}()}else e(null,Lampa.Lang.translate("huyfix_server_not_specified"));function c(){l||Lampa.Noty.show(Lampa.Lang.translate("huyfix_search_sources"))}}function ne(e){var t=Lampa.Controller.enabled().name,n=A(),a=[];a.push({title:Lampa.Lang.translate("huyfix_auto_detect"),auto:!0}),a.push({title:Lampa.Lang.translate("huyfix_select_all_sources"),selectAll:!0,subtitle:Lampa.Lang.translate("huyfix_may_cause_bugs")}),a.push({title:Lampa.Lang.translate("huyfix_reset_default"),reset:!0}),_.forEach((function(e){var t=Lampa.Arrays.isArray(e.id)?e.id[0]:e.id;a.push({title:e.name,source:t,checkbox:!0,checked:-1!==n.indexOf(t)})})),Lampa.Select.show({title:Lampa.Lang.translate("huyfix_choose_sources"),items:a,onBack:function(){var n=a.filter((function(e){return e.checkbox&&e.checked})).map((function(e){return e.source}));0===n.length&&(n=g()),T(n),Lampa.Controller.toggle(t),e&&e()},onSelect:function(t){if(t.auto)te((function(t,n){n?Lampa.Noty.show(n):t&&t.length>0&&(a.forEach((function(e){e.checkbox&&(e.checked=-1!==t.indexOf(e.source))})),T(t),Lampa.Noty.show(Lampa.Lang.translate("huyfix_found_sources")+": "+t.length),Lampa.Select.close(),ne(e))}));else{if(t.selectAll){var n=[];return a.forEach((function(e){e.checkbox&&(e.checked=!0,n.push(e.source))})),T(n),Lampa.Noty.show(Lampa.Lang.translate("huyfix_all_selected")+" ("+n.length+")"),Lampa.Select.close(),void ne(e)}if(t.reset){var i=g();return a.forEach((function(e){e.checkbox&&(e.checked=-1!==i.indexOf(e.source))})),T(i),Lampa.Noty.show(Lampa.Lang.translate("huyfix_sources_reset")),Lampa.Select.close(),void ne(e)}t.checked=!t.checked}}})}function ae(){Lampa.Settings.listener.follow("open",(function(e){"main"==e.name&&(0==Lampa.Settings.main().render().find('[data-component="online_settings"]').length&&Lampa.SettingsApi.addComponent({component:"online_settings",name:Lampa.Lang.translate("huyfix_online_title"),icon:y,before:"interface"}),Lampa.Settings.main().update())})),Lampa.SettingsApi.addParam({component:"online_settings",param:{name:"online_mode_title",type:"title"},field:{name:Lampa.Lang.translate("huyfix_work_mode")}}),Lampa.SettingsApi.addParam({component:"online_settings",param:{name:"online_always_show_choices_toggle",type:"trigger",default:!1},field:{name:Lampa.Lang.translate("huyfix_always_show_choices"),description:Lampa.Lang.translate("huyfix_always_show_choices_desc")},onChange:function(e){E(e)},onRender:function(e){e.find(".settings-param__value").text(F()?Lampa.Lang.translate("huyfix_yes"):Lampa.Lang.translate("huyfix_no")),e.on("hover:enter",(function(){E(!F()),e.find(".settings-param__value").text(F()?Lampa.Lang.translate("huyfix_yes"):Lampa.Lang.translate("huyfix_no"))}))}}),Lampa.SettingsApi.addParam({component:"online_settings",param:{name:"online_use_bwa_toggle",type:"trigger",default:!1},field:{name:Lampa.Lang.translate("huyfix_use_bwa"),description:Lampa.Lang.translate("huyfix_switch_server_bwa")},onChange:function(e){z(e)},onRender:function(e){e.find(".settings-param__value").text(P()?Lampa.Lang.translate("huyfix_yes"):Lampa.Lang.translate("huyfix_no")),e.on("hover:enter",(function(){z(!P()),e.find(".settings-param__value").text(P()?Lampa.Lang.translate("huyfix_yes"):Lampa.Lang.translate("huyfix_no"))}))}}),Lampa.SettingsApi.addParam({component:"online_settings",param:{name:"online_bwa_code_btn",type:"static"},field:{name:Lampa.Lang.translate("huyfix_bwa_code"),description:Lampa.Lang.translate("huyfix_enter_bwa_code")},onRender:function(e){var t=O();e.find(".settings-param__value").text(t||Lampa.Lang.translate("huyfix_not_specified")),e.on("hover:enter",(function(){var t,n;t=function(){var t=O();e.find(".settings-param__value").text(t||Lampa.Lang.translate("huyfix_not_specified"))},n=O(),Lampa.Input.edit({title:Lampa.Lang.translate("huyfix_bwa_code"),value:n,placeholder:"abc1xyz",nosave:!0,free:!0,nomic:!0},(function(e){null!==e?(function(e){Lampa.Storage.set(f,e)}(e=e.trim()),e&&(z(!0),Lampa.Noty.show(Lampa.Lang.translate("huyfix_bwa_saved"))),t&&t()):t&&t()}))}))}}),Lampa.SettingsApi.addParam({component:"online_settings",param:{name:"online_server_title",type:"title"},field:{name:Lampa.Lang.translate("huyfix_own_server")}}),Lampa.SettingsApi.addParam({component:"online_settings",param:{name:"online_add_server_btn",type:"static"},field:{name:Lampa.Lang.translate("huyfix_add_server"),description:Lampa.Lang.translate("huyfix_server_example")},onRender:function(e){e.on("hover:enter",(function(){ee((function(){Lampa.Settings.update()}))}))}}),Lampa.SettingsApi.addParam({component:"online_settings",param:{name:"online_sources_title",type:"title"},field:{name:Lampa.Lang.translate("huyfix_sources_title")}}),Lampa.SettingsApi.addParam({component:"online_settings",param:{name:"online_sources_btn",type:"static"},field:{name:Lampa.Lang.translate("huyfix_choose_sources"),description:Lampa.Lang.translate("huyfix_choose_balancers")},onRender:function(e){e.on("hover:enter",(function(){ne()}))}}),Lampa.SettingsApi.addParam({component:"online_settings",param:{name:"online_servers_title",type:"title"},field:{name:Lampa.Lang.translate("huyfix_servers_list")}}),Lampa.Settings.listener.follow("open",(function(e){"online_settings"==e.name&&ie(e.body)}))}function ie(e){e.find(".online-server-item").remove();var t=L(),n=b(),a=e.find(".settings-param-title").last();if(a.length||(a=e.find(".settings-param").last()),t.forEach((function(t,i){var o=i===n,r=!!D(t),s=[];o&&s.push(Lampa.Lang.translate("huyfix_current_server")),r&&s.push(Lampa.Lang.translate("huyfix_token_set"));var l=s.join(" • "),u=$('<div class="settings-param selector online-server-item" data-server-index="'+i+'"><div class="settings-param__name">'+C(t)+'</div><div class="settings-param__value"></div>'+(l?'<div class="settings-param__descr">'+l+"</div>":"")+"</div>");u.on("hover:enter",(function(){oe(i,(function(){ie(e)}))})),a.after(u),a=u})),0===t.length){var i=$('<div class="settings-param online-server-item"><div class="settings-param__name" style="opacity: 0.5">'+Lampa.Lang.translate("huyfix_not_specified")+"</div></div>");a.after(i)}e.find(".online-server-item").on("hover:focus",(function(){Lampa.Params.listener.send("update_scroll_position")})),Lampa.Params.listener.send("update_scroll")}function oe(e,t,n){var a=L(),i=b(),o=e===i,r=a[e],s=D(r),l=[];o||l.push({title:Lampa.Lang.translate("huyfix_select"),select:!0}),n&&(l.push({title:s?Lampa.Lang.translate("huyfix_change_token"):Lampa.Lang.translate("huyfix_add_token"),token:!0}),s&&l.push({title:Lampa.Lang.translate("huyfix_delete_token"),removeToken:!0})),l.push({title:Lampa.Lang.translate("huyfix_edit"),edit:!0}),l.push({title:Lampa.Lang.translate("huyfix_delete"),remove:!0});var c=Lampa.Controller.enabled().name;Lampa.Select.show({title:C(a[e]),items:l,onBack:function(){Lampa.Controller.toggle(c)},onSelect:function(n){Lampa.Select.close(),n.select?(k(e),t&&t(),setTimeout((function(){Lampa.Controller.toggle(c)}),10)):n.token?Lampa.Input.edit({title:Lampa.Lang.translate("huyfix_server_token"),value:s,nosave:!0,free:!0,nomic:!0},(function(e){null!==e&&(j(r,e.trim()),e.trim()&&Lampa.Noty.show(Lampa.Lang.translate("huyfix_token_saved"))),t&&t(),setTimeout((function(){Lampa.Controller.toggle(c)}),10)})):n.removeToken?(j(r,""),Lampa.Noty.show(Lampa.Lang.translate("huyfix_token_deleted")),t&&t(),setTimeout((function(){Lampa.Controller.toggle(c)}),10)):n.edit?Lampa.Input.edit({title:Lampa.Lang.translate("huyfix_server_address"),value:a[e],placeholder:"192.168.1.1:9118",nosave:!0,free:!0,nomic:!0},(function(n){if(n&&n!==a[e]){var i=D(a[e]);i&&(j(a[e],""),j(n,i)),a[e]=n,Lampa.Storage.set(u,a)}t&&t(),setTimeout((function(){Lampa.Controller.toggle(c)}),10)})):n.remove&&(j(a[e],""),x(e),t&&t(),setTimeout((function(){Lampa.Controller.toggle(c)}),10))},onLong:function(n){n.edit&&(Lampa.Select.close(),oe(e,t,!0))}})}!function(){if(!window.plugin_init){window.plugin_init=!0,ae(),Lampa.Component.add("episodes",Y),Lampa.VPN.region((function(){})),Lampa.Listener.follow("full",(function(e){if("complite"==e.type){var t='<div class="full-start__button selector view--online" data-subtitle="'+(P()?"BWA: "+(O()?O().substring(0,2)+"****":Lampa.Lang.translate("huyfix_not_specified")):Lampa.Lang.translate("huyfix_server")+": "+(C(S())||Lampa.Lang.translate("huyfix_not_specified")))+'">'+y+"<span>"+Lampa.Lang.translate("huyfix_online")+"</span></div>",n=$(Lampa.Lang.translate(t));e.object.activity.render().find(".view--torrent").after(n),n.on("hover:enter",(function(){Lampa.Controller.toggle("content"),new Z(e.data)}))}}));$("body").append("\n\t\t\t<style>\n\t\t\t\t.connect-broken {\n\t\t\t\t\ttext-align: center;\n\t\t\t\t\tpadding-bottom: 1em;\n\t\t\t\t}\n\n\t\t\t\t.connect-broken__title {\n\t\t\t\t\tfont-size: 2em;\n\t\t\t\t\tline-height: 1.4;\n\t\t\t\t}\n\n\t\t\t\t.connect-broken__text {\n\t\t\t\t\tfont-size: 1.2em;\n\t\t\t\t\tpadding-top: 1em;\n\t\t\t\t\tline-height: 1.4;\n\t\t\t\t}\n\n\t\t\t\t.connect-broken__footer {\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\tjustify-content: center;\n\t\t\t\t\tmargin-top: 2em;\n\t\t\t\t}\n\n\t\t\t\t.connect-broken__footer .simple-button {\n\t\t\t\t\tmargin: 0;\n\t\t\t\t}\n\n\t\t\t\t.modal-qr {\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\talign-items: center;\n\t\t\t\t}\n\n\t\t\t\t.modal-qr__left {\n\t\t\t\t\twidth: 33%;\n\t\t\t\t\tflex-shrink: 0;\n\t\t\t\t}\n\n\t\t\t\t.modal-qr__right {\n\t\t\t\t\tpadding-left: 2em;\n\t\t\t\t}\n\n\t\t\t\t.modal-qr__scan {\n\t\t\t\t\ttext-align: center;\n\t\t\t\t\tpadding: 1em;\n\t\t\t\t\tbackground: #fff;\n\t\t\t\t\tborder-radius: 1em;\n\t\t\t\t\tcolor: #000;\n\t\t\t\t}\n\n\t\t\t\t.modal-qr__img {\n\t\t\t\t\tposition: relative;\n\t\t\t\t\twidth: 100%;\n\t\t\t\t\tpadding-bottom: 100%;\n\t\t\t\t\toverflow: hidden;\n\t\t\t\t}\n\n\t\t\t\t.modal-qr__img img {\n\t\t\t\t\tposition: absolute;\n\t\t\t\t\ttop: 0;\n\t\t\t\t\tleft: 0;\n\t\t\t\t\twidth: 100%;\n\t\t\t\t\theight: 100%;\n\t\t\t\t\topacity: 0;\n\t\t\t\t\ttransition: opacity .2s;\n\t\t\t\t}\n\n\t\t\t\t.modal-qr__img img.loaded {\n\t\t\t\t\topacity: 1;\n\t\t\t\t}\n\n\t\t\t\t.modal-qr__bot {\n\t\t\t\t\tfont-size: 1.2em;\n\t\t\t\t\tfont-weight: 600;\n\t\t\t\t}\n\n\t\t\t\t.modal-qr__text {\n\t\t\t\t\tfont-size: 1.2em;\n\t\t\t\t\tline-height: 1.6;\n\t\t\t\t}\n\n\t\t\t\t.modal-qr__text + .modal-qr__text {\n\t\t\t\t\tmargin-top: 3em;\n\t\t\t\t}\n\t\t\t\t.selectbox-item__subtitle {\n\t\t\t\t\topacity: 0.5;\n\t\t\t\t}\n\t\t\t</style>\n\t\t")}}()}();
